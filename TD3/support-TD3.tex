%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                        %%
%%                 Support de cours Algorithmique et Programmation                  %%
%%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Morgan Magnin (Centrale Nantes)
%% création : 10/09/2005
%% dernière modification : 10/09/2005
%% historique :
%% génération du postscript : dvips -t a4 -t landscape -o toto.ps toto
%% génération du pdf : pdflatex toto

%% il faut fixer l'URL base pour que les liens relatifs fonctionnent...
%% bizaremment fichu mais c'est comme ça.


\documentclass[handout]{beamer}


\mode<article> % only for the article version
{
  \usepackage{fullpage}
  \usepackage{hyperref}
}


\mode<presentation>
{
  \setbeamertemplate{background canvas}[vertical shading][bottom=red!10,top=blue!10]

  \usetheme{ECN}
  \usefonttheme[onlysmall]{structurebold}
}

\usepackage{pgf,pgfarrows,pgfnodes,pgfautomata,pgfheaps,pgfshade}
\usepackage{amsmath,amssymb}
\usepackage[latin1]{inputenc}
\usepackage{colortbl}
%\usepackage[french]{babel}
\usepackage{multirow,slashbox}

%\usepackage{lmodern}
%\usepackage[T1]{fontenc} 

\usepackage{times}

\setbeamercovered{dynamic}
\setbeamersize{description width of={ }}

\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{graphicx} 
%\usepackage{epsfig}
\usepackage{xspace}
\usepackage{stmaryrd}
\usepackage{gastex}
\usepackage[latin1]{inputenc}   %accents 8 bits dans le source
\usepackage[english]{algorithme}
%\usepackage[T1]{fontenc} %pour un beau PDF sous Linux ; à retirer sous Mac 
%\usepackage[french]{babel}
%\usepackage{beamerthemesplit}
%\usetheme[compress,secheader]{Madrid}
%\usecolortheme{mybeetle}
\definecolor{newcolor}{rgb}{0, 0, .90}
\definecolor{impcolor}{rgb}{.90, 0, 0}
\newcommand{\New}[1]{\textcolor{newcolor}{#1}}
\newcommand{\Imp}[1]{\textcolor{impcolor}{#1}}
\newcommand{\ie}{\emph{i.e.}\xspace}
\newcommand{\To}[1]{\stackrel{#1}{\rightarrow}}
\newcommand{\setN}{\mathbb N} % à utiliser en mode mathématique
\newcommand{\setR}{\mathbb R} % à utiliser en mode mathématique
\newcommand{\setB}{\mathbb B} % à utiliser en mode mathématique
\newcommand{\setZ}{\mathbb Z} % à utiliser en mode mathématique
\newcommand{\setQ}{\mathbb Q} % à utiliser en mode mathématique
\newbox\soulbox% nouvelle boite
\newcommand{\souligne}[1]{%
\setbox\soulbox\hbox{#1}% memorisation du texte dans la boite
#1% affichage du texte
\hskip-\wd\soulbox% deplacement de la largeur du texte vers la gauche
\lower1pt\hbox{\rule{\wd\soulbox}{.1mm}}% affichage d'une barre de 1/10 de mm
                                        % a 1pt sous le texte et de la largeur
                                        % de ce texte
}
%------ Commandes spécifiques -------
\newcommand{\ii}{\^{\i}}%---- \ii = î

\newlength{\comlen}
\newbox\combox

\newcommand{\commenta}[2]{%
\setbox\combox\hbox{#1}
\setlength{\comlen}{0pt}
\addtolength{\comlen}{\wd\combox}
\addtolength{\comlen}{-\linewidth}
\noindent{#1}\hspace*{2mm}\begin{minipage}[t]{-\comlen}{/* #2 */}\end{minipage}
}
\newcommand{\commentz}[2]{%
\setbox\combox\hbox{#1}
\setlength{\comlen}{0pt}
\addtolength{\comlen}{\wd\combox}
\addtolength{\comlen}{-\linewidth}
\noindent{#1}\hspace*{2mm}\begin{minipage}[t]{-\comlen}{/~#2~/}\end{minipage}
}

\def\dest{}
\def\destina{}
\def\titre{concernant \dest}
%----------------------------------


%-------- Pour l'index ------------
\newcommand{\Indexttrepete}[1]{\texttt{#1}\index{#1@\texttt{#1}}}
\newcommand{\Indextt}[1]{\index{#1@\texttt{#1}}}
\newcommand{\Indexttbf}[1]{\index{#1@\texttt{#1}|textbf}}
%------------Les mots clés --------
\newcommand{\const}{\noindent {\tt \souligne{constante}}}
\newcommand{\var}{\noindent {\tt \souligne{variable}}}
\newcommand{\varloc}{\noindent {\tt \souligne{variable locale}}}
\newcommand{\type}{\noindent {\tt \souligne{type}}}
\newcommand{\reel}{{\tt \souligne{réel}} }
\newcommand{\entier}{{\tt \souligne{entier}} }
\newcommand{\car}{{\tt \souligne{caractère}} }
\newcommand{\bool}{{\tt \souligne{booléen}} }
%
\newcommand{\consts}{\noindent {\tt \souligne{constantes}}}
\newcommand{\vars}{\noindent {\tt \souligne{variables}}}
\newcommand{\varlocs}{\noindent {\tt \souligne{variables locales}}}
\newcommand{\types}{\noindent {\tt \souligne{types}}}
\newcommand{\reels}{{\tt \souligne{réels}} }
\newcommand{\entiers}{{\tt \souligne{entiers}} }
\newcommand{\cars}{{\tt \souligne{caractères}} }
\newcommand{\bools}{{\tt \souligne{booléens}} }
%
\newcommand{\et}{{\tt \souligne{et}} }
\newcommand{\ou}{{\tt \souligne{ou}} }
\newcommand{\non}{{\tt \souligne{non}} }
%
\newcommand{\vecteur}{{\tt \souligne{vecteur}} }
\newcommand{\matrice}{{\tt \souligne{matrice}} }
\newcommand{\tableau}{{\tt \souligne{tableau}} }
%
\newcommand{\vecteurs}{{\tt \souligne{vecteurs}} }
\newcommand{\matrices}{{\tt \souligne{matrices}} }
\newcommand{\tableaux}{{\tt \souligne{tableaux}} }
%
\newcommand{\sousfonction}{fonction}
\newcommand{\sousfonctions}{fonctions}
\newcommand{\fonction}{fonction}
\newcommand{\fonctions}{fonctions}
%
\newcommand{\prog}{\noindent {\tt \souligne{fonction principale}}\\ }
\newcommand{\sprog}[1]{\noindent {\tt \souligne{fonction} {#1} }\\}
%\newcommand{\action}[1]{\noindent {\tt \souligne{action} {#1} }\\}
\newcommand{\prob}[1]{\noindent {\tt \souligne{problème}~:} {#1} \\}
\newcommand{\princi}[1]{\noindent {\tt \souligne{principe}~:} {#1} \\}
%
\newcommand{\specifp}[2]{\noindent{\tt \souligne{spécification}~:  }\\
\hspace*{5mm}\begin{tabular}{ll}
\souligne{{\tt constantes}}~: & \begin{minipage}[t]{135mm}
                                  {{#1}}   \end{minipage}\\
\souligne{{\tt types}}~: & \begin{minipage}[t]{135mm}
                                  {{#2}}   \end{minipage}\\
\end{tabular}\\}
%
\newcommand{\specif}[3]{\noindent{\tt \souligne{spécification}~:  }\\
\hspace*{5mm}\begin{tabular}{ll}
\souligne{{\tt fonction}}~: & \begin{minipage}[t]{135mm}
                                  {{#1}}   \end{minipage}\\
\souligne{{\tt paramètres}}~: & \begin{minipage}[t]{135mm}
                                  {{#2}}   \end{minipage}\\
\souligne{{\tt résultats}}~: & \begin{minipage}[t]{135mm}
                                  {{#3}}   \end{minipage}\\
\end{tabular} \\
}
%
\newcommand{\specifaction}[3]{\noindent{\tt \souligne{spécification}~:  }\\
\hspace*{5mm}\begin{tabular}{ll}
\souligne{{\tt action}}~: & \begin{minipage}[t]{135mm}
                                  {{#1}}   \end{minipage}\\
\souligne{{\tt paramètres}}~: & \begin{minipage}[t]{135mm}
                                  {{#2}}   \end{minipage}\\
\souligne{{\tt résultat}}~: & \begin{minipage}[t]{135mm}
                                  {{#3}}   \end{minipage}\\
\end{tabular} \\
}
%
%\newcommand{\varloc}[1]{\souligne{{\tt variables locales}}\\ \hspace*{5mm} {\tt #1}}
\newcommand{\debut}{\noindent\souligne{{\tt début}}\\}
\newcommand{\fin}{\noindent\souligne{{\tt fin}}\\}
%
\newcommand{\vardecal}[1]{\hspace*{10mm}{#1}\\}
%
\newcommand{\enreg}{\souligne{{\tt Enregistrement}}\\}
\newcommand{\finenreg}{\souligne{{\tt Fin\_enregistrement}}\\}
%
\newcommand{\norm}[1]{\noindent{\tt {#1}}\\ }
\newcommand{\normc}[1]{\noindent{\tt {#1}}\\ }
\newcommand{\decal}[1]{\noindent {\tt
\hspace*{5mm} \begin{minipage}[t]{155mm}
                                  {{#1}} \end{minipage}
                        }\\ }
\newcommand{\decalc}[1]{\noindent{\tt \hspace*{5mm} \begin{minipage}[t]{155mm}
                                  {{#1}}
                                  \end{minipage}
                        }\\ }
\newcommand{\decala}[1]{{\tt \hspace*{20mm} \begin{minipage}[t]{135mm}
                                  {{#1}}  \end{minipage}
                        }\\ }
\newcommand{\decalb}[1]{{\tt \hspace*{30mm} \begin{minipage}[t]{120mm}
                                  {{#1}}
                                  \end{minipage}
                        }\\ }
\newcommand{\decald}[1]{{\tt \hspace*{40mm} \begin{minipage}[t]{110mm}
                                  {{#1}}
                                  \end{minipage}
                        }\\ }
%
\newcommand{\inst}[1]{\noindent{\tt ~|~~ {#1}}\\ }
\newcommand{\instr}[1]{\noindent{\tt ~|~~~|~~ {#1}}\\ }
\newcommand{\instru}[1]{\noindent{\tt ~|~~~|~~~|~~ {#1}}\\ }
\newcommand{\instruc}[1]{\noindent{\tt ~|~~~|~~~|~~~|~~ {#1}}\\ }
\newcommand{\instruct}[1]{\noindent{\tt ~|~~~|~~~|~~~|~~~|~~ {#1}}\\ }
\newcommand{\instructi}[1]{\noindent{\tt ~|~~~|~~~|~~~|~~~|~~~|~~ {#1}}\\ }
%
\newcommand{\pour}[2]{{\tt \souligne{pour} {~#1~} \souligne{à} {~#2~} \souligne{faire} }}
\newcommand{\finpour}{{\tt \souligne{fin pour} }}
%
\newcommand{\si}[1]{{\tt \souligne{si} {~#1~} \souligne{alors}}}
\newcommand{\finsi}{{\tt \souligne{fin si}}}
\newcommand{\sinon}{{\tt \souligne{sinon}}}
%
\newcommand{\tantque}[1]{{\tt \souligne{tant que} {~#1~} \souligne{faire} }}
\newcommand{\fintantque}{{\tt \souligne{fin tant que} }}
%
\newcommand{\choixselon}{{\tt \souligne{choix selon}~:}}
\newcommand{\finchoixselon}{{\tt \souligne{fin choix selon}}}
%
\newcommand{\lire}[1]{{\tt \souligne{lire}{~(#1)}}}
\newcommand{\ecrire}[1]{{\tt \souligne{écrire}{~(#1)}}}
\newcommand{\renvoyer} [1]{{\tt \souligne{renvoyer}{~#1} }}
%
\newcommand{\bl}{$\flat$}
%
\newcommand{\algo}{\noindent{\tt\fbox{algorithme}}\\}
\newcommand{\cc}{\noindent{\textsf\fbox{C}}\\}
\newcommand{\ccp}{\noindent{\textsf\fbox{C++}}\\}
\newcommand{\ccc}{{\textsf C/C++ } }
\newcommand{\boitsoul}[1]{\noindent\fbox{#1}}
%
\newcommand{\remarque}{\noindent{\em Remarque}~:~}
\newcommand{\remarques}{\noindent{\em Remarques}~:~}
%
\newcommand{\attention}{\noindent{\em Attention}~:~}
%
\newcommand{\exemplei}[1]{\noindent{\em Exemple~#1}~:\\}
\newcommand{\exemple}{\noindent{\em Exemple}~:\\}
\newcommand{\exemples}{\noindent{\em Exemples}~:\\}
%
\newcommand{\parag}[1]{\medskip\noindent{\textbf{\em #1}}~:\\}
%
\newcommand{\ty}{t\_}
%
\newcommand{\uu}[1]{souligne{#1}}
\newtheorem{condition}{Condition}

\title[Programmation structurée]{Programmation structurée}
\author[Morgan Magnin]{\textbf{Morgan Magnin} \\ Bureau E214 \\ 
\texttt{morgan.magnin@irccyn.ec-nantes.fr}}
\institute[Centrale Nantes]{
  Ecole Centrale de Nantes \\
  1, rue de la No\"{e} \\
  B.P. 92101 \\
  44321 Nantes Cedex 3 \\
  France}
\date{Mars 2012}

\AtBeginSection[] % Do nothing for \section*
{ 
\frame<beamer> 
	{ 
	\frametitle{Overview} 
	\tableofcontents[current]
	} 
}

\begin{document}

\frame{\titlepage}

%\section[Table of contents]{}
\frame{\tableofcontents}

\section{Gestion des programmes et sous-programmes en C}

\frame{
  \frametitle{Programmation structurée (p69)}
  
  \begin{itemize}
  \item \textbf{A la compilation}, le type d'une fonction, son nom et la liste des types de
ses paramètres \alert{doivent être connus avant son utilisation}. 
\item Si toutes les fonctions d'un programme sont écrites \textbf{dans un même fichier}, le programme
principal est donc en fin de fichier. 
\item Problème d'une telle disposition : aucune réutilisabilité des sous-programmes $\rightarrow$ à éviter !
  \end{itemize}
}

\frame{
  \frametitle{Fichiers en-tête (p70)}
  
  \begin{itemize}
  \item Ecrire les sous-programmes dans \textbf{des fichiers séparés}, compilables séparément. 
  \item Nécessité, pour l'unité de programme utilisant un sous-programme, de connaître \textbf{le prototype} du sous-programme. 
  \item Première solution : répéter le prototype du sous-programme en en-tête de toutes les unités de programme en ayant besoin.
  \item \alert{Seconde solution (la bonne !)} : 
  \begin{itemize}
	\item pour chaque sous-programme, \textbf{écrire son prototype} dans un fichier à part, appelé \alert{fichier en-tête} ;
	\item \textbf{inclure le fichier en-tête} en début de chaque fichier où le sous-programme est utilisé. 
  \end{itemize}
  \end{itemize}
}

\frame[allowframebreaks]{
  \frametitle{Contenu des fichiers en-tête (p70)}
  
  \begin{itemize}
  \item Contient la \textbf{traduction en C des informations figurant dans la spécification} écrite dans le dossier algorithmique.
  \item Constantes et types de données utilisés dans tous les éléments du programme sont définis dans le fichier en-tête correspondant au programme principal - \textbf{fichier ensuite inclus dans tous les fichiers contenant des sous-programmes utilisant tout ou partie de ces éléments}. 
  \end{itemize}
  
  \framebreak
  
  \begin{itemize}
  \item Fichiers source et en-tête dans le même répertoire
  \item Commencer le fichier source par l'inclusion de son fichier en-tête 
  \item \texttt{\#include "MonFichier.h"}
  \end{itemize}
  
}

\section{Introduction aux pointeurs}


\frame{
  \frametitle{Passage des arguments par valeur ou par adresse (pointeur) (p64)}
  
  \begin{itemize}
\item \textbf{Passage par valeur} : une variable (copie de l'argument) est créée \textbf{localement} au niveau du sous-programme appelé :
  \begin{itemize}
	\item durée de vie limitée à celle du sous-programme ;
	\item valeur initiale $=$ valeur de l'argument d'appel.  
	\item \alert{La modification du paramètre correspondant à l'argument dans le sous-programme n'induit pas de modification de la valeur de l'argument.}
  \end{itemize}
\item \textbf{Passage par adresse} : fonction appelée et fonction appelante manipulent \textbf{un même objet} grâce à son adresse (pointeur vers cet objet). 
% fonction appelée et fonction appelante manipulent \textbf{un unique objet} connu éventuellement sous deux noms différents : 
%   \begin{itemize}
% 	\item son nom en tant qu'argument, utilisé dans la fonction appelante,
% 	\item son nom en tant que paramètre, utilisé dans le sous-programme appelé.
%   \end{itemize}
  \end{itemize}
}

\frame[allowframebreaks]{
  \frametitle{Les pointeurs (p45)}
  
    \begin{alertblock}{Objectif}
Pourquoi des pointeurs ?
  \end{alertblock}
  
  \begin{block}{Avantages}
  \begin{itemize}
\item Manipuler des données de \textbf{taille importante}
\item Accéder à la \textbf{mémoire} de l'ordinateur
\item Créer des \textbf{structures chaînées}
  \end{itemize}
  \end{block}
  
  \framebreak
  
  \begin{alertblock}{Objectif}
Comment accéder à l'adresse mémoire à laquelle est stockée une variable ?
  \end{alertblock}
  
  \begin{block}{Méthode}
  \begin{itemize}
\item Mémoire de l'ordinateur $\approx$ tableau où chaque case peut contenir un octet 
\item Indice d'une case $=$ \textbf{adresse mémoire}
\item \{ Adresse mémoire $+$ Type \} $\Rightarrow$ valeur
\item Pour chaque type de données \texttt{T}, on peut définir un type \textbf{pointeur sur} \texttt{T}, noté \texttt{T*}
  \end{itemize}
  \end{block}
  
\framebreak

\begin{itemize}
\item Exemple n°1 : manipulation de pointeur sur un \entier
  \begin{itemize}
\item Déclaration via \texttt{int* p;} 
\item Accès au contenu via \texttt{*p} (\textbf{déréférencement de pointeur}) 
  \end{itemize}
\item Exemple n°2 : manipulation d'une variable de type \entier
  \begin{itemize}
\item Déclaration via \texttt{int a;} 
\item Accès à l'adresse mémoire via \texttt{\&a} 
  \end{itemize}
\end{itemize}

\framebreak
\begin{itemize}
\item Exemple : \\
\texttt{int a;}\\
\texttt{int* p;}\\
\texttt{p = \&a;}\\
\texttt{*p = 2;}
  \end{itemize}
  
  \framebreak
  
  

}

\section{Plusieurs valeurs et/ou un tableau renvoyés}

\frame[allowframebreaks]{
  \frametitle{Cas où plusieurs valeurs (ou un tableau) sont renvoyées (p66)}
  
Si la fonction renvoie un tableau et / ou plusieurs valeurs, sa traduction peut se faire~:
\begin{itemize}
\item soit en utilisant un nouveau type~;
\item  soit \textbf{en utilisant la possibilité de modifier certains des paramètres} : grâce à des pointeurs vers des variablesx. %ce que nous allons voir ici.
\end{itemize}

\framebreak
\begin{itemize}
\item Dans ce deuxième cas, il n'y a pas de résultat explicitement retourné, donc il n'y a pas de {\tt return},
\item Traduction via une fonction de type {\tt void}. 
\item Deux possibilités de traduction selon que certains arguments d'appel peuvent être modifiés ou non par la fonction.
\end{itemize}

\framebreak
\begin{itemize}
\item \textbf{Si les arguments ne doivent pas être modifiés par la fonction} : il faudra ajouter autant de paramètre(s) lors de la traduction qu'il y a de valeur(s) à renvoyer.
\item \textbf{Si certains arguments peuvent être modifiés par le sous-programme} : ces arguments seront directement utilisés, sans création d'un nouveau paramètre. Passage par adresse : utilisation d'un pointeur, noté en C avec le symbole \texttt{*} (accès à l'adresse d'une variable grâce au symbole  \texttt{\&}).
\end{itemize}

}


\section{Méthodologie pour le choix de la traduction}

\frame[allowframebreaks]{
  \frametitle{Méthodologie pour le choix de la traduction (p68)}
  
  \begin{itemize}
\item \textbf{Si la fonction renvoie une seule valeur de type {\tt UnType} simple ou enregistrement} : utiliser une fonction ayant pour type {\tt UnType}.
\item \textbf{Si la fonction, dans sa spécification algorithmique, ne renvoie pas de valeur} : il faut utiliser
une fonction de type {\tt void}.
  \end{itemize}
  Dans ces deux cas, les arguments doivent être passés \alert{par valeur}.

\framebreak

\textbf{Si la fonction renvoie plusieurs valeurs} : 
\begin{itemize}
  \item créer une structure pertinente au regard de l'application (cf. TD 3) ;
  \item ou \textbf{utiliser une fonction de type} \texttt{void} :
  \begin{itemize}
    \item créer un nouveau paramètre et utiliser \textbf{le passage par adresse} :
    \begin{itemize}
       \item[.]{si une valeur renvoyée ne correspond pas à une variable déjà utilisée dans la fonction appelante,}
      \item[.]{si une valeur renvoyée correspond à une variable déjà utilisée dans la fonction appelante,
mais que cette variable ne doit pas être modifiée.}
    \end{itemize}
   \item utiliser \textbf{le passage par adresse} sans créer de nouveau paramètre si une valeur renvoyée correspond à une variable déjà utilisée dans la fonction appelante
et qui peut être modifiée.
  \end{itemize}
\end{itemize}
}


\section[Application]{Exemples d'application}

\frame[allowframebreaks]{
  \frametitle{Exemples}
  
  \'Ecrivez l'appel à chacune des fonctions suivantes et analysez les conséquences de cet appel.\\
\medskip

\begin{columns}
\begin{column}[l]{5.5cm}
\texttt{void f1 (int i, int j)\\
\{\\
~~~i=j;\\
\}}\\
\bigskip

\texttt{void f2 (int *i, int *j)\\
\{\\
~~~i=j;\\
\}}
\end{column}
\begin{column}[r]{5.5cm}
\texttt{void f3 (int *i, int *j)\\
\{\\
~~~*i=*j;\\
~~~*j=*i;\\
\}}\\
~\\
~\\
~\\
~\\
\end{column}
\end{columns}

\framebreak

\textbf{Exercice : manipulation de fonctions}\\
\'Ecrire une fonction échange(a, b) qui échange les valeurs de a et de b.

\textbf{Exercice : manipulation de fonctions et de vecteurs}\\
\'Ecrire une fonction qui modifie le prix d'un article. Puis écrire une autre fonction qui modifie le prix d'un article dans untableau.

\framebreak 

\textbf{Exercice : plus petite valeur d'une suite}\\
\'Etant donnée une file de valeurs entières positives, de longueur inconnue, on demande d'écrire un algorithme permettant de déterminer :
\begin{itemize}
\item la plus petite de ces valeurs,
\item le nombre de ses apparitions,
\item le rang de sa première apparition dans la file.
\end{itemize}

\framebreak

\textbf{Exercice : moyennes de valeurs dans une suite}\\
Calculer :
\begin{itemize}
\item le nombre de valeurs respectivement positives, nulles ou négatives,
\item la moyenne arithmétique des valeurs positives et celle des valeurs négatives d'une file de valeurs numériques terminée par une butée.
\end{itemize}

}

\section{À préparer}
\frame
{
  \frametitle{See you next week!}
  
  \begin{alertblock}{Pour le prochain TP}
  Préparer la partie algorithmique du TP, et revoir : 
  \begin{itemize}
  \item Manipulation des tableaux et des enregistrements 
  \item Fonctions
  \end{itemize}
  \end{alertblock}
  
  \begin{block}{Pour le prochain TD}
  Comprendre et maîtriser les éléments suivants : 
  \begin{itemize}
  \item Lecture/écriture dans des fichiers (chap. 11.3)
  \item Tris (chap. 9)
  \end{itemize}  
  \end{block}
  
}

\end{document}
